### 计网的解忧杂货铺



#### 服务器保持了大量的TIME_WAIT状态

- time_wait出现在主动断开连接的一方在响应fin时进入的状态，为2ML，主机会在time_wait结束后再回收这个连接的资源，这个状态的作用有两个:
  1) 防止此次连接的包，在网络阻塞一段时间后再到达服务器，影响下一次连接，经过2MSL后，所有此次连接的在网络中的包都会被路由器丢弃
  2) 可靠的关闭TCP连接，主动方发送的最后一个ack报文可能会在网络中丢失，此时由于被动方没有接收到ack，会再次发送fin报文，这时如果主动方不等待2MSL直接进入CLOSE的话，就会响应RST而不是ACK

